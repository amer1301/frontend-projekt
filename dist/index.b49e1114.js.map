{"mappings":"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","sources":["OneDrive/Skrivbord/frontend-projekt/main.js"],"sourcesContent":["let map;  // Skapa en global variabel för kartan\r\n\r\n// Hämtar koordinater från Nominatim API (OpenStreetMap)\r\nasync function getCoordinates(location) {\r\n    try {\r\n        const response = await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(location)}&addressdetails=1`);\r\n        const data = await response.json();\r\n        \r\n        if (data.length > 0) {\r\n            const lat = data[0].lat;\r\n            const lon = data[0].lon;\r\n            updateMap(lat, lon);  // Uppdatera kartan med de nya koordinaterna\r\n            getTrafficInfo(lat, lon, location);  // Hämta trafikinfo för den nya platsen\r\n        } else {\r\n            alert('Platsen kunde inte hittas!');\r\n        }\r\n    } catch (error) {\r\n        console.error('Fel vid hämtning av koordinater:', error);\r\n        alert('Något gick fel när platsen skulle sökas.');\r\n    }\r\n}\r\n\r\n// Uppdaterar kartan med en ny plats\r\nfunction updateMap(lat, lon) {\r\n    // Om kartan inte har initialiserats än, skapa den\r\n    if (!map) {\r\n        map = L.map('map').setView([lat, lon], 13);  // Skapar en karta med den valda platsen\r\n        \r\n        // Lägg till OpenStreetMap lager\r\n        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\r\n            attribution: '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\r\n        }).addTo(map);\r\n    } else {\r\n        // Om kartan redan finns, bara uppdatera center och zoom\r\n        map.setView([lat, lon], 13);\r\n    }\r\n\r\n    // Lägg till markör på den valda platsen\r\n    L.marker([lat, lon]).addTo(map)\r\n        .bindPopup('Du sökte efter denna plats')\r\n        .openPopup();\r\n}\r\n\r\n// Eventlyssnare för att hämta koordinater när användaren söker\r\ndocument.getElementById('search-btn').addEventListener('click', function() {\r\n    const location = document.getElementById('location-input').value;\r\n    if (location) {\r\n        getCoordinates(location);  // Hämtar koordinater för den angivna platsen\r\n    } else {\r\n        alert('Vänligen ange en plats!');\r\n    }\r\n});\r\n\r\n// Hämtar trafikmeddelanden baserat på plats\r\nasync function getTrafficInfo(userLat, userLon, location) {\r\n    const infoDiv = document.getElementById(\"info\");\r\n    infoDiv.innerHTML = \"\";\r\n\r\n    const url = `https://api.sr.se/api/v2/traffic/messages?format=json&search=${encodeURIComponent(location)}`;\r\n    const response = await fetch(url);\r\n    const data = await response.json();\r\n\r\n    displayTrafficInfo(data); // Visa trafikinformationen i info-diven\r\n    addTrafficMarkers(data, userLat, userLon); // Lägg till markörer för trafikstörningar på kartan\r\n}\r\n\r\n// Visa trafikmeddelanden på sidan\r\nfunction displayTrafficInfo(data) {\r\n    const infoDiv = document.getElementById(\"info\");\r\n    infoDiv.innerHTML = \"\";\r\n\r\n    if (data.messages && data.messages.length > 0) {\r\n        data.messages.forEach(message => {\r\n            const messageElement = document.createElement(\"article\");\r\n\r\n            const title = document.createElement(\"h3\");\r\n            title.textContent = message.title || \"Trafikmeddelande\";\r\n            messageElement.appendChild(title);\r\n\r\n            const description = document.createElement(\"p\");\r\n            description.textContent = message.description || \"Ingen ytterligare information.\";\r\n            messageElement.appendChild(description);\r\n\r\n            infoDiv.appendChild(messageElement);\r\n        });\r\n    } else {\r\n        const noInfo = document.createElement(\"p\");\r\n        noInfo.textContent = \"Ingen trafikinfo tillgänglig för den valda platsen.\";\r\n        infoDiv.appendChild(noInfo);\r\n    }\r\n}\r\n\r\n// Lägg till markörer för trafikstörningar på kartan\r\nfunction addTrafficMarkers(data, userLat, userLon) {\r\n    if (data.messages && data.messages.length > 0) {\r\n        data.messages.forEach(message => {\r\n            // Kolla om vi har latitud och longitud för varje meddelande\r\n            const lat = message.latitude;\r\n            const lon = message.longitude;\r\n            \r\n            // Filtrera bort trafikmeddelanden som är långt borta från användarens sökta plats\r\n            const distance = getDistance(userLat, userLon, lat, lon);\r\n            if (distance < 50) { // 50 km avstånd, kan justeras beroende på behov\r\n                // Lägg till en markör på kartan där störningen inträffar\r\n                L.marker([lat, lon]).addTo(map)\r\n                    .bindPopup(`\r\n                        <strong>${message.title}</strong><br>\r\n                        ${message.description || \"Ingen ytterligare information.\"}<br>\r\n                        <em>Allvarlighetsgrad: ${getPriorityLabel(message.priority)}</em>\r\n                    `)\r\n                    .openPopup();\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\n// Hjälpfunktion för att beräkna avstånd mellan två geografiska punkter (i kilometer)\r\nfunction getDistance(lat1, lon1, lat2, lon2) {\r\n    const R = 6371; // Jordens radie i kilometer\r\n    const dLat = (lat2 - lat1) * Math.PI / 180;\r\n    const dLon = (lon2 - lon1) * Math.PI / 180;\r\n    const a = Math.sin(dLat / 2) * Math.sin(dLat / 2) +\r\n              Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *\r\n              Math.sin(dLon / 2) * Math.sin(dLon / 2);\r\n    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\r\n    return R * c; // Avståndet i kilometer\r\n}\r\n\r\n// Hjälpfunktion för att ge en mer läsbar text för prioriteten\r\nfunction getPriorityLabel(priority) {\r\n    switch (priority) {\r\n        case 1: return \"Mycket allvarlig händelse\";\r\n        case 2: return \"Stor händelse\";\r\n        case 3: return \"Störning\";\r\n        case 4: return \"Information\";\r\n        case 5: return \"Mindre störning\";\r\n        default: return \"Okänd prioritet\";\r\n    }\r\n}\r\n"],"names":[],"version":3,"file":"index.b49e1114.js.map","sourceRoot":"/__parcel_source_root/"}